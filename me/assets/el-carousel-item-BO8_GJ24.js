import{aT as p,b as U,X as E,as as _,i as ee,d as x,ar as te,u as ae,bc as se,l as u,bd as re,be as ne,f,au as le,w as oe,j as ie,o as c,c as v,r as z,s as j,D as ue,a,n as C,I as R,bf as V,q as g,v as ce,x as de,_ as fe,ab as ve,bg as pe,a0 as me,bh as ge,bi as $,bj as ye,G as we}from"./index-DFPMoMCa.js";import{E as he}from"./index-Ww4EvrqK.js";const be=(s,r)=>{if(!p||!s||!r)return!1;const t=s.getBoundingClientRect();let n;return r instanceof Element?n=r.getBoundingClientRect():n={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},t.top<n.bottom&&t.bottom>n.top&&t.right>n.left&&t.left<n.right},Le=U({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:E([String,Object])},previewSrcList:{type:E(Array),default:()=>_([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:E(String)}}),Se={load:s=>s instanceof Event,error:s=>s instanceof Event,switch:s=>ee(s),close:()=>!0,show:()=>!0},ke=x({name:"ElImage",inheritAttrs:!1}),Ee=x({...ke,props:Le,emits:Se,setup(s,{emit:r}){const t=s;let n="";const{t:H}=te(),i=ae("image"),M=se(),I=u(()=>re(Object.entries(M).filter(([e])=>/^(data-|on[A-Z])/i.test(e)||["id","style"].includes(e)))),D=ne({excludeListeners:!0,excludeKeys:u(()=>Object.keys(I.value))}),w=f(),m=f(!1),d=f(!0),h=f(!1),y=f(),o=f(),F=p&&"loading"in HTMLImageElement.prototype;let b,L;const K=u(()=>[i.e("inner"),S.value&&i.e("preview"),d.value&&i.is("loading")]),q=u(()=>{const{fit:e}=t;return p&&e?{objectFit:e}:{}}),S=u(()=>{const{previewSrcList:e}=t;return le(e)&&e.length>0}),W=u(()=>{const{previewSrcList:e,initialIndex:l}=t;let P=l;return l>e.length-1&&(P=0),P}),B=u(()=>t.loading==="eager"?!1:!F&&t.loading==="lazy"||t.lazy),k=()=>{p&&(d.value=!0,m.value=!1,w.value=t.src)};function Y(e){d.value=!1,m.value=!1,r("load",e)}function G(e){d.value=!1,m.value=!0,r("error",e)}function A(){be(y.value,o.value)&&(k(),T())}const N=ye(A,200,!0);async function O(){var e;if(!p)return;await ve();const{scrollContainer:l}=t;pe(l)?o.value=l:me(l)&&l!==""?o.value=(e=document.querySelector(l))!=null?e:void 0:y.value&&(o.value=ge(y.value)),o.value&&(b=$(o,"scroll",N),setTimeout(()=>A(),100))}function T(){!p||!o.value||!N||(b==null||b(),o.value=void 0)}function X(e){if(e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function Z(){S.value&&(L=$("wheel",X,{passive:!1}),n=document.body.style.overflow,document.body.style.overflow="hidden",h.value=!0,r("show"))}function J(){L==null||L(),document.body.style.overflow=n,h.value=!1,r("close")}function Q(e){r("switch",e)}return oe(()=>t.src,()=>{B.value?(d.value=!0,m.value=!1,T(),O()):k()}),ie(()=>{B.value?O():k()}),(e,l)=>(c(),v("div",V({ref_key:"container",ref:y},a(I),{class:[a(i).b(),e.$attrs.class]}),[m.value?z(e.$slots,"error",{key:0},()=>[j("div",{class:C(a(i).e("error"))},ue(a(H)("el.image.error")),3)]):(c(),v(R,{key:1},[w.value!==void 0?(c(),v("img",V({key:0},a(D),{src:w.value,loading:e.loading,style:a(q),class:a(K),crossorigin:e.crossorigin,onClick:Z,onLoad:Y,onError:G}),null,16,["src","loading","crossorigin"])):g("v-if",!0),d.value?(c(),v("div",{key:1,class:C(a(i).e("wrapper"))},[z(e.$slots,"placeholder",{},()=>[j("div",{class:C(a(i).e("placeholder"))},null,2)])],2)):g("v-if",!0)],64)),a(S)?(c(),v(R,{key:2},[h.value?(c(),ce(a(he),{key:0,"z-index":e.zIndex,"initial-index":a(W),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"url-list":e.previewSrcList,crossorigin:e.crossorigin,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:J,onSwitch:Q},{default:de(()=>[e.$slots.viewer?(c(),v("div",{key:0},[z(e.$slots,"viewer")])):g("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):g("v-if",!0)],64)):g("v-if",!0)],16))}});var ze=fe(Ee,[["__file","image.vue"]]);const Be=we(ze);export{Be as E};
